# 重定向

## 文件描述符

> 用法详见 [输出重定向](重定向.md#输出重定向-`>`-`>>`)

- `0` 标准输入
- `1` 标准输出
- `2` 标准错误输出
- `&` 标准输出和标准错误输出

## 输入重定向 `<` `<<`

### `<`

> 个人理解: `<` 就是为了将文件作为参数传给 shell 脚本而存在的.

```shell
# 将 tools_1.txt 重定向到 sort.sh 脚本中
./sort.sh < ./tools_1.txt
```

命令行输出

```shell
使用标准输入内容进行排序：
----------------------------------------
assert.test.ts
csv.test.ts
csv.ts
date.test.ts
date.ts
jsonb.sql
zsqk
----------------------------------------
按ASCII码降序排列的结果：
----------------------------------------
zsqk
jsonb.sql
date.ts
date.test.ts
csv.ts
csv.test.ts
assert.test.ts
----------------------------------------
```

### `<<`

todo

## 输出重定向 `>` `>>`

### `>`

#### 查找存在的目录

1. 将输出重定向到文件中

   ```shell
   # 查看tools目录下的文件, 并将结果保存到tools.txt文件中
   ls tools > tools.txt
   ```

   tools.txt 文件内容如下:

   ```
   assert.test.ts
   csv.test.ts
   csv.ts
   date.test.ts
   date.ts
   jsonb.sql
   zsqk

   ```

---

2. 使用标准输出重定向执行上述命令, 并将结果保存到 tools_1.txt 文件中

   ```shell
   # 查看tools目录下的文件, 并将结果保存到tools.txt文件中
   ls tools 1> tools_1.txt
   ```

   tools_1.txt 文件内容如下:

   ```
   assert.test.ts
   csv.test.ts
   csv.ts
   date.test.ts
   date.ts
   jsonb.sql
   zsqk

   ```

---

3. 使用标准错误输出重定向执行上述命令, 并将结果保存到 tools_2.txt 文件中

   ```shell
   # 查看tools目录下的文件, 并将结果保存到tools.txt文件中
   ls tools 2> tools_2.txt
   ```

   tools_2.txt 内容为空

#### 查找存在的目录

1. 查找不存在的目录

   ```shell
   # 查找不存在的目录
   ls tool
   ```

   命令行输出 `ls: tool: No such file or directory`

---

2. 查找不存在的目录, 使用`>` 重定向标准输出到文件中
   ```shell
   # 查找不存在的目录, 使用 > 重定向标准输出到文件中
   ls tool > tool.txt
   ```
   结果:
   - 生成 `tool.txt` 文件, 内容为空
   - 命令行输出为`ls: tool: No such file or directory`

---

3. 查找不存在的目录, 使用`1>` 重定向标准输出到文件中

   ```shell
   # 查找不存在的目录, 使用1> 重定向标准输出到文件中
   ls tool >> tool_1.txt
   ```

   结果:

   - 生成 `tool_1.txt` 文件, 内容为空
   - 命令行输出为`ls: tool: No such file or directory`

---

4. 查找不存在的目录, 使用`2>` 重定向标准错误输出到文件中

   ```shell
   # 查找不存在的目录, 使用2> 重定向标准错误输出到文件中
   ls tool 2> tool_2.txt
   ```

   结果:

   - 生成 `tool_2.txt` 文件, 内容为

   ```txt
   ls: tool: No such file or directory

   ```

#### 使用 &> 同时查找存在的目录和不存在的目录

```shell
# 查找不存在的目录, 使用 &> 重定向标准输出和标准错误输出到文件中
ls tool &> tool_3.txt
```

结果:

- 生成 `tool_3.txt` 文件, 内容为

  ```txt
  ls: tool: No such file or directory
  tools:
  assert.test.ts
  csv.test.ts
  csv.ts
  date.test.ts
  date.ts
  jsonb.sql
  zsqk

  ```

### `>>`

todo

## shell 脚本

> 该脚本对传入的文件内容进行排序

```shell
#!/bin/bash

# 定义默认内容
DEFAULT_CONTENT="apple
Banana
cherry
Date
elderberry
Fig
Grape"

# 存储要处理的内容
content=""

# 检查输入来源：文件参数 > 标准输入 > 默认内容
if [ $# -eq 1 ]; then
    # 处理文件参数
    if [ -f "$1" ]; then
        content=$(cat "$1")
    else
        echo "错误：文件 '$1' 不存在或不是有效文件" >&2
        exit 1
    fi
elif [ ! -t 0 ]; then
    # 处理标准输入（输入重定向或管道）
    content=$(cat -)  # 读取所有标准输入内容
    echo "使用标准输入内容进行排序："
    echo "----------------------------------------"
    echo "$content"
    echo "----------------------------------------"
else
    # 使用默认内容
    content="$DEFAULT_CONTENT"
    echo "未提供输入，使用默认内容进行排序："
    echo "----------------------------------------"
    echo "$content"
    echo "----------------------------------------"
fi

# 按ASCII码降序排列并显示结果
echo "按ASCII码降序排列的结果："
echo "----------------------------------------"
echo "$content" | sort -rd
echo "----------------------------------------"
```
